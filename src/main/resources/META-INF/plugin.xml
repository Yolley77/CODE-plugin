<idea-plugin>
    <id>ru.codeplugin.methodology</id>
    <name>CODE Methodology (Simple)</name>
    <vendor email="you@example.com">CODE Team</vendor>
    <version>0.1.0</version>

    <depends>com.intellij.modules.platform</depends>
    <depends>Git4Idea</depends>

    <extensions defaultExtensionNs="com.intellij">
        <notificationGroup id="CODE" displayType="BALLOON"/>
        <postStartupActivity implementation="ru.codeplugin.startup.CodeStartupActivity"/>
        <toolWindow id="CODE" factoryClass="ru.codeplugin.ui.CodeToolWindowFactory" anchor="right"/>

        <localInspection
                implementationClass="ru.codeplugin.inspections.NotFormattedInspection"
                shortName="CodeNotFormatted"
                displayName="Файл не отформатирован (CODE)"
                groupPath="CODE"
                enabledByDefault="true" language=""/>
    </extensions>

    <actions>
        <group id="ru.codeplugin.actions.CodeToolbarGroup"
               text="CODE"
               popup="true"
               icon="/icons/code.svg">
            <add-to-group group-id="MainToolbarRight" anchor="last"/>

            <!-- PREPARE -->
            <action id="ru.codeplugin.action.prepare"
                    class="ru.codeplugin.actions.ValidateBranchNameAction"
                    text="Prepare: Validate Branch Name"
                    description="Проверить, что текущая ветка соответствует CODE branch_format"/>

            <!-- DEVELOP -->
            <action id="ru.codeplugin.action.develop"
                    class="ru.codeplugin.actions.RunDevelopChecksAction"
                    text="Develop: Check and Format Current File"
                    description="Запустить проверку/форматирование текущего файла по Code Style"/>

            <!-- CONTROL -->
            <action id="ru.codeplugin.action.control"
                    class="ru.codeplugin.actions.ControlChecklistAction"
                    text="Control: Coverage Checklist"
                    description="Показать чек-лист проверки покрытия тестов через Run with Coverage"/>

            <!-- APPLY: теперь реальная проверка числа изменённых файлов -->
            <action id="ru.codeplugin.action.apply"
                    class="ru.codeplugin.actions.ApplyValidateChangesAction"
                    text="Apply: Validate Changed Files Count"
                    description="Проверить, что количество изменённых файлов не превышает лимит из CODE.yaml"/>

            <!-- Перечитать конфиг -->
            <action id="ru.codeplugin.action.reloadConfig"
                    class="ru.codeplugin.actions.ReloadCodeConfigAction"
                    text="Reload CODE.yaml"
                    description="Перечитать конфигурацию CODE из CODE.yaml"/>
        </group>
    </actions>

</idea-plugin>
